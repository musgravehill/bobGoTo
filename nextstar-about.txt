Несколько вопросов просят меня по–подробнее описать. Как Стеллариум отправляет/принимает через виртуальный СОМ-порт данные и по функции action() символы e,z,b,r (в case) за какие режимы отвечают? Сюда пропишу, т.к. не все очевидно там.

Из всего множества команд NextStar Communication Protocol (прилагается), стеллариум оперирует только двумя необходимыми и достаточными для целей позиционирования монтировки сомандами: «e» - запрос точных (precise) экваториальных координат наведения и «r» - команда перехода на указанные точные экваториальные координаты. Обе команды оперируют парой положительных восьмизначных шестнадцатеричных чисел, разделенных запятой. Первое число в такой паре – прямое восхождение, определяемое как (0xFFFFFFFF/24)*(прямое восхождение в часах), второе число – склонение, рассчитываемое как (0xFFFFFFFF/360)*(Склонение в градусах). Прием/передача данных завершается символом «#».
Таким образом, отправив в порт запрос «e», стеллариум ожидает ответ в виде 18 байт данных например: «34AB0500,12CE0500#». Количество полученных байтов подсчитывается, неправильные наборы данных, содержащие больше или меньше 18 байт, считаются ошибкой и отбрасываются. Команда позиционирования отправляемая стеллариумом в порт имеет вид «r34AB0500,12CE0500», в ответ ожидает «#».
При подключении ардуино к стеллариуму выяснилось еще, что запрос «e» от стеллариума до ардуино не доходит, приходится по таймеру, каждую секунду текущие координаты в порт засылать.
Первая из задач, которую должен решать подключаемый напрямую к стеллариуму модуль, это общение по порту, распознавание команд и формирование ответов. В моих скетчах за это отвечает функция void action(String STRA), которая анализирует поступающие из порта данные (String STRA) и формирует и отправляет в порт адекватный ответ. Команды «e» «r» описал выше, команды «z» и «b» запрограммированы для общения по порту с компьютера в «ручном режиме», их поведение не соответствует требованиям NextStar Communication Protocol. Команды «z» и «b» оперируют обычными десятичными числами. «z» - запрос текущих азимутальных координат наведения, «b» - команда позиционирования на указанные азимутальные координаты (азимут, отсчитываемый от севера и высота), причем в указании высоты допускается указывать отрицательные числа. Например: «b350.25,-15.150» переведет монтировку на азимут 350,25 град и 15,15 град ниже горизонта.